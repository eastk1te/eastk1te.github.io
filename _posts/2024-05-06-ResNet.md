---
title: '[Paper]ResNet'
author: east
date: 2024-05-06 00:00:00 +09:00
categories: [Paper, NN]
tags: [Paper, NN, Residual learning]
math: true
mermaid: true
# pin: true
# image:
#    path: image preview url
#    alt: image preview text
# 
# 
---

ResNetì€ 2015ë…„ì— microsoft ì—°êµ¬ì›ë“¤ì— ì˜í•´ ì œì•ˆëœ "Deep Residual Learning for Image Recognition" ë…¼ë¬¸ì„ í†µí•´ ì œì•ˆëœ ì•„ì¼€í…ì³ìž…ë‹ˆë‹¤. í˜„ìž¬ê¹Œì§€ 20ë§ŒíšŒê°€ ë„˜ì–´ê°€ëŠ” ì¸ìš©ìˆ˜ë¥¼ ê°€ì§€ëŠ” ë…¼ë¬¸ì¸ ë§Œí¼ ë”¥ëŸ¬ë‹ ëª¨ë¸ì˜ ì£¼ìš” ê¸°ë²• ì¤‘ í•˜ë‚˜ë¡œ ê·¸ëž˜ë””ì–¸íŠ¸ ì†Œì‹¤ ë¬¸ì œì™€ ì‹ ê²½ë§ì˜ ì„±ëŠ¥ì„ í˜ì‹ ì ìœ¼ë¡œ ê°œì„ í•˜ì˜€ìŠµë‹ˆë‹¤.

> ## â… . Residual Network 

í•´ë‹¹ ë…¼ë¬¸ì—ì„œ "residual laering framework"ë¡œ ë” ê¹Šì–´ì§€ëŠ” ì‹ ê²½ë§ ë„¤íŠ¸ì›Œí¬ì—ì„œ í•™ìŠµ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ëª…ì‹œì ìœ¼ë¡œ layerë¥¼ ìž¬êµ¬ì„±í•˜ì—¬ ì¸µ ìž…ë ¥ì„ ì°¸ì¡°í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

![1](https://github.com/eastk1te/eastk1te.github.io/assets/77319450/197eb870-1717-4f21-a313-cde9f58a96b9)
_Figure 1 : ë” ê¹Šê³  ë³µìž¡í•œ ì‹ ê²½ë§ì¼ ìˆ˜ë¡ ë” ì„±ëŠ¥ì´ ì•ˆì¢‹ì•„ì§_

ì‹ ê²½ë§ì—ì„œ ì¸µì˜ ê¹Šì´ëŠ” ì„±ëŠ¥ì— ë§¤ìš° ì¤‘ìš”í•œ ì—­í• ì„ í•˜ì§€ë§Œ ë‹¨ìˆœí•˜ê²Œ ë§Žì´ ìŒ“ì„ ìˆ˜ë¡ ì„±ëŠ¥ì´ ë” ì¢‹ì•„ì§€ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ ì´ìœ ëŠ” ê·¸ëž˜ë””ì–¸íŠ¸ í­ë°œì´ë‚˜ ì†Œì‹¤ì— ê´€í•œ ë¬¸ì œë¡œ ì •ê·œí™” ë“±ì˜ ë¬¸ì œë¡œ í•´ê²°í•´ì•¼í•©ë‹ˆë‹¤.

ìœ„ ê·¸ë¦¼ì—ì„œ í™•ì¸ ê°€ëŠ¥í•˜ë“¯ì´ ì‹ ê²½ë§ì´ ë” ê¹Šì–´ì§ˆ ìˆ˜ë¡ ì„±ëŠ¥ì´ ì•ˆì¢‹ì•„ì§€ëŠ” ê²°ê³¼ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤. ì‹ ê²½ë§ì´ ìˆ˜ë ´ê°€ëŠ¥í•˜ë”ë¼ë„ ê¹Šì´ê°€ ì¦ê°€í•¨ì— ë”°ë¼ ì •ë³´ ì „ë‹¬ëŸ‰ì´ ì €í•˜ë˜ë©° ì„±ëŠ¥ì´ ë–¨ì–´ì§€ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë¬¸ì œëŠ” ê³¼ì í•©ì˜ ë¬¸ì œê°€ ì•„ë‹Œ ê¹Šì€ ì‹ ê²½ë§ì„ ì‚¬ìš©í•´ì„œ ìƒê¸°ëŠ” ì˜¤ë¥˜ìž…ë‹ˆë‹¤.

ì¦‰, ë³´í†µì˜ ì‹ ê²½ë§ì€ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ ë” ë§Žì€ ë ˆì´ëŸ¬ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ì§€ë§Œ í•­ìƒ ì„±ëŠ¥ì´ í–¥ìƒë˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. ì´ëŸ° ê²½ìš° ì¡´ìž¬í•˜ëŠ” í•´ê²°ì±…ìœ¼ë¡œ ì¶”ê°€ëœ ë ˆì´ì–´ê°€ ê¸°ì¡´ì˜ ë ˆì´ì–´ë¡œë¶€í„° ìž…ë ¥ê°’ì„ ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ëŠ” identity mappingì„ ì ìš©í•˜ê³ , ë‹¤ë¥¸ ì¸µì— í•™ìŠµëœ ì–•ì€ ëª¨ë¸ë¡œë¶€í„° ë³µì‚¬ëœ ë ˆì´ì–´ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒìž…ë‹ˆë‹¤.

ì´ë ‡ê²Œ êµ¬ì¶•ëœ ì†”ë£¨ì…˜ì€ ì–•ì€ ëª¨ë¸ê³¼ ë¹„êµí–ˆì„ë•Œ ì‹¤í—˜ì ìœ¼ë¡œ ë†’ì€ í•™ìŠµ ì˜¤ë¥˜ë¥¼ ë³´ì´ì§€ ì•Šì•„ ì„±ëŠ¥ ì €í•˜ í˜„ìƒì„ ì™„í™”ì‹œí‚¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

![2](https://github.com/eastk1te/eastk1te.github.io/assets/77319450/4eb2ce05-620a-48a2-bce4-92f98bda7f17)
_Figure 2 : Residual learning : a building block_

í•´ë‹¹ ë…¼ë¬¸ì—ì„œ ìœ„ì™€ ê°™ì€ ì„±ëŠ¥ ì €í•˜ ë¬¸ì œë¥¼ "deep residual learning framwork"ë¼ëŠ” "ìž”ì°¨ í•™ìŠµ" ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤. ë ˆì´ì–´ë¥¼ ë¬´ìž‘ì • ìŒ“ëŠ” ê²ƒ ëŒ€ì‹  ì§ì ‘ì ìœ¼ë¡œ ì›í•˜ëŠ” "underlying mapping"(ì¦‰, ê¸°ì € ë§¤í•‘)ì„ ì í•©í•˜ì—¬ ëª…ì‹œì ìœ¼ë¡œ ë ˆì´ì–´ê°€ ìž”ì°¨ í•™ìŠµì¸ "residual mapping" ì„ ìˆ˜í–‰í•˜ê²Œ ë§Œë“­ë‹ˆë‹¤.

$$F(x) := H(x) - x$$

$$H(\cdot)$$ì€ ê¸°ì € ë§¤í•‘ìœ¼ë¡œ ë¹„ì„ í˜• ë ˆì´ì–´ì— ë‹¤ë¥¸ ë§¤í•‘ $$F(\cdot)$$ì„ ì í•©í•˜ê²Œ ë˜ë©´ $$F(x) + x$$ì™€ ê°™ì´ ìž¬êµ¬ì„±ë˜ê²Œ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ìž”ì°¨ ë§¤í•‘ì„ ìµœì í™”í•˜ëŠ” ë°©ë²•ì´ ì›ëž˜ì˜ ë§¤í•‘ì„ ì§ì ‘ì ìœ¼ë¡œ ìµœì í™”í•˜ëŠ” ê²ƒë³´ë‹¤ ì‰¬ìš¸ê±°ë¼ëŠ” ê°€ì„¤ì„ ë…¼ë¬¸ì—ì„œ ì œì‹œí•˜ì˜€ìŠµë‹ˆë‹¤.

íŠ¹ížˆ, ì›ëž˜ì˜ ë§¤í•‘ì´ ê¸°ì € ë§¤í•‘ìœ¼ë¡œ ìµœì í™”ë˜ëŠ” ê²½ìš°ì—ëŠ” ìž”ì°¨ë¥¼ ë¹„ì„ í˜• ë ˆì´ì–´ë¥¼ í†µí•´ ê¸°ì € ë§¤í•‘ì— ì í•©í•˜ëŠ” ê²ƒë³´ë‹¤ ìž”ì°¨ë¥¼ 0ìœ¼ë¡œ ë§Œë“œëŠ” ê²ƒì´ ë” ì‰½ìš¸ ê²ƒì´ë¼ê³  í•©ë‹ˆë‹¤.

ì´ë ‡ê²Œ ìž¬êµ¬ì„±ëœ $$F(x) + x$$ë¥¼ í”¼ë“œí¬ì›Œë“œ ì‹ ê²½ë§ê³¼ "shortcut connections"ìœ¼ë¡œ í•¨ê»˜ í‘œí˜„ë˜ê²Œ ë©ë‹ˆë‹¤. ìˆì»· ì—°ê²°ì€ í•˜ë‚˜ ì´ìƒì˜ ì¸µì„ ë„˜ì–´ê°€ë©´ì„œ ê°„ë‹¨í•˜ê²Œ í•­ë“± ë§¤í•‘ì„ ìˆ˜í–‰í•˜ê³ , ì´ ê²°ê³¼ëŠ” ìŒ“ì¸ ë ˆì´ì–´ì˜ ì¶œë ¥ì— ë”í•´ì§‘ë‹ˆë‹¤. ì´ëŸ¬í•œ ì—°ê²°ì€ ì¶”ê°€ì˜ íŒŒë¼ë¯¸í„°ê°€ ìš”êµ¬ë˜ì§€ ì•Šê³ , ê³„ì‚° ë³µìž¡ì„±ë„ ì¶”ê°€ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.


> ## â…¡. Deep Residual Learning

> ### â…°. Residual Learning

$$H(x)$$ë¥¼ ê¸°ì € ë§¤í•‘ìœ¼ë¡œì„œ ê³ ë ¤í•˜ì—¬ stacked ë ˆì´ì–´ì— ì ìš©í•œë‹¤ê³  ìƒê°í•©ì‹œë‹¤. ë§Œì•½ ì—¬ëŸ¬ ë¹„ì„ í˜• ì¸µì´ ì´ë¡ ì ìœ¼ë¡œ ìž…ë ¥ xì— ëŒ€í•´ ì›í•˜ëŠ” ì¶œë ¥ì„ ìƒì„±í•˜ëŠ” ì™„ë²½í•œ í•¨ìˆ˜ì— ì ê·¼ì ìœ¼ë¡œ ì ‘ê·¼í•œë‹¤ë©´ $$F(x) := H(x) - x$$ì™€ ê°™ì´ ìž”ì°¨ í•¨ìˆ˜ë¡œ ê·¼ì‚¬í™”ë˜ê²Œ ë©ë‹ˆë‹¤. ë”°ë¼ì„œ, $$H(x)$$ëŠ” $$F(x) + x$$ê°€ ë  ìˆ˜ ìžˆìœ¼ë©° ë‘ í˜•íƒœ ëª¨ë‘ ì ê·¼ì ìœ¼ë¡œ ì›í•˜ëŠ” í•¨ìˆ˜ë¡œ ê·¼ì‚¬í•˜ì§€ë§Œ í•™ìŠµì˜ ìš©ì´ì„± ì¸¡ë©´ì—ì„œëŠ” ì°¨ì´ë¥¼ ë³´ìž…ë‹ˆë‹¤.

ì´ëŸ¬í•œ ì ‘ê·¼ë²•ì˜ ìž¬êµ¬ì„±ì€ ì„±ëŠ¥ ì €í•˜ ë¬¸ì œì— ëŒ€í•´ í•´ê²°ì±…ì„ ì œê³µí•©ë‹ˆë‹¤. ì•žì„œ ì„¤ëª…í•œ ê²ƒê³¼ ê°™ì´ `í•­ë“± ë§¤í•‘ì„ êµ¬í˜„í•˜ëŠ” ì¸µ(F(x) + x)ì„ ë”í•¨`ìœ¼ë¡œì¨ ë” ê¹Šì€ ëª¨ë¸ì´ ì–•ì€ ëª¨ë¸ë³´ë‹¤ ì„±ëŠ¥ì´ ë–¨ì–´ì§€ëŠ” ê²ƒì„ ë°©ì§€(`ì¦‰, ë” ì™„ë²½í•œ í•¨ìˆ˜ì— ê¹Šì€ ëª¨ë¸ì´ ì ê·¼ì ìœ¼ë¡œ ê·¼ì‚¬í•¨`)í•©ë‹ˆë‹¤. ì´ëŠ” ì„±ëŠ¥ ì €í•˜ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ í•´ê²°ì±…ìœ¼ë¡œ ì—¬ëŸ¬ ë¹„ì„ í˜• ë ˆì´ëŸ¬ë¥¼ í†µí•´ í•­ë“± ë§¤í•‘ì— ê·¼ì‚¬í•˜ëŠ” ì–´ë ¤ì›€ì„ ê·¹ë³µí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ìž”ì°¨ í•™ìŠµì„ í†µí•´ ìž¬í˜•ì‹í™”í•˜ë©´ í•´ê²°ì±…ì€ ë‹¨ìˆœížˆ ì—¬ëŸ¬ ë¹„ì„ í˜• ë ˆì´ì–´ì˜ ê°€ì¤‘ì¹˜ë¥¼ 0ìœ¼ë¡œ ìˆ˜ë ´ì‹œì¼œ í•­ë“± ë§¤í•‘ì— ê·¼ì ‘í•  ìˆ˜ ìžˆê²Œ ë©ë‹ˆë‹¤. í˜„ì‹¤ì ìœ¼ë¡œ ì´ëŸ¬í•œ ê³¼ì •ì€ ìµœì ì´ ë  ìˆ˜ ì—†ì§€ë§Œ ë„ì›€ì´ ë  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ë‹¤ì‹œë§í•´ ìµœì ì˜ í•¨ìˆ˜ê°€ í•­ë“± ë§¤í•‘ì— ê°€ê¹ë‹¤ë©´ ìž”ì°¨ í•™ìŠµì„ í†µí•´ ë„¤íŠ¸ì›Œí¬ë¥¼ ìµœì í™”í•˜ëŠ” ê²ƒì´ ë” ì‰½ê²Œ ë©ë‹ˆë‹¤.


> ### â…±. Identity Mapping by Shorcuts

ìž”ì°¨ í•™ìŠµì€ ì—¬ëŸ¬ stacked ë ˆì´ì–´ì— ëª¨ë‘ ì ìš©ë©ë‹ˆë‹¤.

$$y = \mathbf{F}(x, {W_i}) + x$$

ð¹ì€ ìž”ì°¨ ë§¤í•‘ì„ í‘œí˜„í•©ë‹ˆë‹¤. ì´ë¥¼ Figure 2ì˜ ì˜ˆì‹œë¡œ ë‘ê°œì˜ ì¸µì´ ì¡´ìž¬í•˜ì—¬ $$F = W_2\sigma(W_1x)$$ê°€ ë©ë‹ˆë‹¤. $$\sigma$$ ëŠ” ë¹„ì„ í˜• í•¨ìˆ˜ì´ê³ , $$ð¹ + x$$ëŠ” "shortcut connection"ê³¼ "element-wise addition"ì„ í†µí•´ ìˆ˜í–‰ë©ë‹ˆë‹¤.

ìœ„ ì‹ì—ì„œ ìˆì»· ì—°ê²°ì€ ì¶”ê°€ì˜ íŒŒë¼ë¯¸í„°ë‚˜ ê³„ì‚° ë³µìž¡ë„ê°€ ìš”êµ¬ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì´ì ì€ í˜„ì‹¤ì—ì„œ íš¨ìœ¨ì„± ì¸¡ë©´ì—ì„œ ì¤‘ìš”í•˜ê³ , ê¸°ì¡´ì˜ ë„¤íŠ¸ì›Œí¬ì™€ ë¹„êµí•´ì„œ ê³µí‰í•œ ë¹„êµê°€ ê°€ëŠ¥í•˜ê²Œ ë©ë‹ˆë‹¤.

$$y = ð¹(x, {W_i}) + W_sx$$

ì—¬ê¸°ì„œ $$W_s$$ëŠ” ì •ë°© í–‰ë ¬ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

> ### â…². Network Architectures

![3](https://github.com/eastk1te/eastk1te.github.io/assets/77319450/f3afd966-2881-4cf0-877a-837038ea4767)
_Figure 3 : ImageNetì—ì„œ í•™ìŠµí–ˆì„ë•Œ ì™¼ìª½ plain ë„¤íŠ¸ì›Œí¬ì—ì„œ ì¸µì´ ê¹Šì–´ì§ˆìˆ˜ë¡ ì„±ëŠ¥ì´ ì•ˆì¢‹ì•„ì§€ì§€ë§Œ ResNetì—ì„œëŠ” ê¹Šì–´ì§ˆìˆ˜ë¡ ì„±ëŠ¥ì´ ë” ì¢‹ì•„ì§€ëŠ” ê²ƒì„ í™•ì¸ ê°€ëŠ¥í•¨._

í•´ë‹¹ ë…¼ë¬¸ì—ì„œì˜ ì‹¤í—˜ ê²°ê³¼ë¡œ ê°ì²´ íƒì§€ ë¶„ì•¼ì—ì„œ ìž”ì°¨ í•™ìŠµì„ í†µí•´ ì¢‹ì€ ì¼ë°˜í™” ì„±ëŠ¥ì„ ë³´ì—¬ì£¼ì—ˆë‹¤ê³  í•©ë‹ˆë‹¤. ë˜í•œ, 1000ê°œì˜ layerë„ íƒìƒ‰í•´ë³´ì•˜ìœ¼ë‚˜ 110 layerë³´ë‹¤ ì„±ëŠ¥ì´ ì•ˆì¢‹ì•˜ëŠ”ë°, ì´ëŸ¬í•œ ë¬¸ì œëŠ” ê³¼ì í•© ë¬¸ì œë¡œ ì¼ì • í•œê³„ê°€ ì¡´ìž¬í•œë‹¤ê³  í–ˆìŠµë‹ˆë‹¤.

ResNetì—ì„œ ì‚¬ìš©ëœ ìž”ì°¨ í•™ìŠµ ë°©ë²•ì€ Visionë¶„ì•¼ì—ì„œ Residaul Blockìœ¼ë¡œ ë§Žì´ ì‚¬ìš©ë˜ê³  ìžˆìœ¼ë©° NLP ë¶„ì•¼ì—ì„œë„ Transformerì™€ ê°™ì€ ìž”ì°¨ ì—°ê²°ë¡œ ë§Žì´ ì‚¬ìš©ë˜ê³  ìžˆìŠµë‹ˆë‹¤.

> ## â…¢. Code


```python
@tf.keras.utils.register_keras_serializable(package='Vision')
class ResidualBlock(tf.keras.layers.Layer):

   ...

  def call(self, inputs, training=None):
    shortcut = inputs

    ...

    x = self._conv1(inputs)
    x = self._norm1(x)
    x = self._activation_fn(x)

    x = self._conv2(x)
    x = self._norm2(x)

    ...

    # residual connection.
    return self._activation_fn(x + shortcut)
```

> ## â…£. REFERENCES

1. [Deep Residual Learning for Image Recognition](https://arxiv.org/pdf/1512.03385.pdf)

<br><br>
---